{% extends "base.html" %}
{% load static %}
{% block title %}
	Display Charts
{% endblock %}
{% block head %} 
	<script src="https://cdn.jsdelivr.net/npm/chart.js@2.9.3/dist/Chart.min.js" ></script>
{% endblock %}
{% block content %}
	<h1> Display Graph...</h1>
	<div class="chart-container" style="position: relative; height:30vh; width:50vw">
		<canvas id="myChart" width=20 height=30></canvas>	
	</div>
{% endblock %}
{% block scripts %}

	<script>
		function draw_chart(stat,chart_type="pie"){
			var ctx = document.getElementById('myChart').getContext('2d');
			var myChart = new Chart(ctx, {
				type: chart_type,
				data: {
					labels: ['Severe', 'Medium', 'Light'],
					datasets: [{
						label: 'Crime categories',
						data: stat,
						backgroundColor: [
							'rgba(255, 99, 132, 0.2)',
							'rgba(54, 162, 235, 0.2)',
							'rgba(255, 206, 86, 0.2)',
							'rgba(75, 192, 192, 0.2)',
							'rgba(153, 102, 255, 0.2)',
							'rgba(255, 159, 64, 0.2)'
						],
						borderColor: [
							'rgba(255, 99, 132, 1)',
							'rgba(54, 162, 235, 1)',
							'rgba(255, 206, 86, 1)',
							'rgba(75, 192, 192, 1)',
							'rgba(153, 102, 255, 1)',
							'rgba(255, 159, 64, 1)'
						],
						borderWidth: 1
					}]
				},
				options: {
					scales: {
						yAxes: [{
							ticks: {
								beginAtZero: true
							}
						}]
					}
				}
			});
		}

		var endpoint = '/case/api/data'
		var crime_stat = []
		$.ajax({
			method: "GET",
			url: endpoint,
			success: function(data){
				console.log(data)
				crime_stat = data.crime_stat
				console.log(crime_stat)
				draw_chart(crime_stat,data.chart_type)
			},
			error: function(error_data){
				console.log("error")
				console.log(error_data)
			}
		})
	
	</script>
		
{% endblock %}