{% load staticfiles %}
<html>
<head>
	<meta charset="UTF-8">
	<meta http-equiv="X-UA-Compatible" content="IE=edge">
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<title>
		{% block title %}{% endblock %}
	</title>
	<link href="{% static "css/bootstrap.min.css" %}" rel="stylesheet" type="text/css">
	<link href="{% static "css/styles.css" %}" rel="stylesheet" type="text/css">
	{% block head %}{% endblock %}
</head>
<body >
<div id="ErrorModal" class="modal fade" role="dialog">
	<div class="modal-dialog modal-sm">
	<!-- Modal content-->
	<div class="modal-content">
	  <div class="modal-header">
		<button type="button" class="close" data-dismiss="modal">&times;</button>
		<h4 class="modal-title">Error</h4>
	  </div>
	  <div class="modal-body">
		<p>{{ error }}</p>
	  </div>
	</div>
  </div>
</div>
<nav class="navbar navbar-inverse navbar-fixed-top">
	<div class="container-fluid">
		<div class="navbar-header">
			<button type="button" class="navbar-toggle" data-toggle="collapse" data-target="#topnav">
					<span class="glyphicon glyphicon-option-vertical" style="color:white"></span>
			</button>
			<a class="navbar-brand" href="{% url "index" %}" {% if request.path == '/' %}style="color:white"{% endif %}>CRS</a>
		</div>

		<div class="collapse navbar-collapse" id="topnav">
			<ul class="nav navbar-nav white" id="lnav">
				<li><a href="{% url "new-case" %}">Add New Case</a></li>
				<li><a href="{% url "charts" %}">Charts</a></li>				
			</ul>
			<script>
				function active_nav(){
					ln=document.getElementById("lnav")
					links=ln.getElementsByTagName("a")
					for(i=0;i<links.length;i++){
						a=links[i]
						link_name=a.getAttribute("href")
						if ("{{ request.path }}" == link_name){
							a.parentElement.className="active"
						}
					}
				}
				active_nav()
			</script>
		
			<ul class="nav navbar-nav navbar-right">
				{% if user.is_authenticated %}
				<li class="dropdown">
        			<a class="dropdown-toggle" data-toggle="dropdown" href="#">{{user}}
        				<span class="caret"></span></a>
        			<ul class="dropdown-menu" style="text-align:center">
          				<li><a href="#" class="glyphicon glyphicon-user"> Profile</a></li>
          				<li><a href="{% url "logout" %}" class="glyphicon glyphicon-log-out"> Logout</a></li>
          				<li></li>
        			</ul>
      			</li>
				{% else %}
					<li><a href="" data-toggle="modal" data-target="#loginModal"><span  class="glyphicon glyphicon-log-in" style="font-weight:bold"> Login</span> </a></li>
				{% endif %}
			</ul>
		</div>
	</div>
</nav>
<div class="modal fade" id="loginModal" role="dialog">
    <div class="modal-dialog modal-sm">
      <div class="modal-content">
      	<div class="modal-header">
        	<button type="button" class="close" data-dismiss="modal">&times;</button>
          	<h4 style="color:red;"><span class="glyphicon glyphicon-lock"></span> Login</h4>
        </div>
        <div class="modal-body">
          	<form method="POST" action="{% if "login" not in request.path %}login{% endif %}" role="form">
          	{% csrf_token %}
            <div class="form-group">
              	<label for="username"><span class="glyphicon glyphicon-user"></span> Username</label>
              	<input type="text" name="username" class="form-control" id="username" placeholder="Enter username">
            </div>
            <div class="form-group">
             	<label for="password"><span class="glyphicon glyphicon-eye-open"></span> Password</label>
              	<input type="password" name="password" class="form-control" id="password" placeholder="Enter password">
            </div>
            <input type="submit" value="Login" class="btn btn-default btn-success btn-block">
          </form>
        </div>
        <div class="modal-footer">
          <button type="submit" value="Connect" class="btn btn-default pull-left" data-dismiss="modal"><span class="glyphicon glyphicon-remove"></span> Cancel</button>
          <p>Not a member? <a href="{% url "index" %}">Sign Up</a></p>
          <p>Forgot <a href="#">Password?</a></p>
        </div>
      </div>
    </div>
  </div>
</div>

{% block content %}{% endblock %}

<footer class="container-fluid text-center hid" style="background:black;height:50px;padding-top:15px;color:white">
			 &copy; {% now "Y" %} Criminal Recording System.
</footer>
<script src="{% static "js/script.js" %}"></script>
<script src="{% static "js/lib/jquery-2.1.4.min.js" %}"></script>
<script src="{% static "js/lib/bootstrap.min.js" %}"></script>
{% block scripts %}{% endblock %}
{% if error %}
	<script>
		err_modal=$("#ErrorModal")
		err_modal.modal()
		setTimeout(closeModal,5000)
		function closeModal(){
			err_modal.modal("hide");
		}
	</script>
{% endif %}
{% if login_required and not user.is_authenticated %}
    <script>
      $("#loginModal").modal()
    </script>
{% endif %}
</body>
</html>